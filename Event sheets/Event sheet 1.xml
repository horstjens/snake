<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>Event sheet 1</name>
    <events>
        <include>Event sheet 2</include>
        <variable comment="add this as global to avoid accessing a segment at recalculation the new health of the head" name="segmentInitialHealth" type="number">0</variable>
        <variable name="dist" type="number">0</variable>
        <comment>8direction is disabled for testing movement with only 2 buttons</comment>
        <event-block>
            <conditions>
                <condition id="-2" name="On start of layout" type="System" />
            </conditions>
            <actions>
                <action id="-9" name="Set value" type="System">
                    <param id="0" name="Variable">dist</param>
                    <param id="1" name="Value">segment(0).initialHealth</param>
                </action>
            </actions>
            <sub-events>
                <event-block>
                    <conditions>
                        <condition id="-19" name="Pick all" type="System">
                            <param id="0" name="Object">head</param>
                        </condition>
                    </conditions>
                    <actions />
                </event-block>
                <event-block>
                    <conditions>
                        <condition id="-19" name="Pick all" type="System">
                            <param id="0" name="Object">segment</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Destroy" type="segment" />
                        <action id="0" name="Log Text" type="ChromeConsole">
                            <param id="0" name="Data">&quot;destroy segment at startup&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-block>
        <event-block>
            <conditions>
                <condition id="-6" name="Every X seconds" type="System">
                    <param id="0" name="Interval (seconds)">3.0</param>
                </condition>
            </conditions>
            <actions>
                <action id="-3" name="Create object" type="System">
                    <param id="0" name="Object to create">food</param>
                    <param id="1" name="Layer">0</param>
                    <param id="2" name="X">random(LayoutWidth)</param>
                    <param id="3" name="Y">random(LayoutHeight)</param>
                </action>
            </actions>
        </event-block>
        <event-block>
            <conditions>
                <condition id="0" name="On key pressed" type="Keyboard">
                    <param id="0" name="Key">32 (Leer)</param>
                </condition>
                <condition id="-7" name="Compare instance variable" type="head">
                    <param id="0" name="Instance variable">player_number</param>
                    <param id="1" name="Comparison">0</param>
                    <param id="2" name="Value">0</param>
                </condition>
            </conditions>
            <actions>
                <action id="0" name="Spawn another object" type="head">
                    <param id="0" name="Object">spit</param>
                    <param id="1" name="Layer">0</param>
                    <param id="2" name="Image point">3</param>
                </action>
                <action id="5" name="Set frame" type="spit">
                    <param id="0" name="Frame number">head.player_number</param>
                </action>
                <action id="2" name="Stop" type="spit" />
                <action id="-10" name="Set value" type="spit">
                    <param id="0" name="Instance variable">strength</param>
                    <param id="1" name="Value">head.totalStrength</param>
                </action>
                <action id="-5" name="Set width" type="spit">
                    <param id="0" name="Width">self.initialSize*(1+ ((self.strength/self.initialStrength-1)*self.scaleFactor))</param>
                </action>
                <action id="-6" name="Set height" type="spit">
                    <param id="0" name="Height">self.initialSize*(1+ ((self.strength/self.initialStrength-1)*self.scaleFactor))</param>
                </action>
            </actions>
        </event-block>
        <event-block disabled="1">
            <conditions>
                <condition disabled="1" id="0" name="On key pressed" type="Keyboard">
                    <param id="0" name="Key">16 (Umschalt)</param>
                </condition>
                <condition disabled="1" id="-7" name="Compare instance variable" type="head">
                    <param id="0" name="Instance variable">player_number</param>
                    <param id="1" name="Comparison">0</param>
                    <param id="2" name="Value">0</param>
                </condition>
            </conditions>
            <actions>
                <action disabled="1" id="0" name="Spawn another object" type="head">
                    <param id="0" name="Object">spit</param>
                    <param id="1" name="Layer">0</param>
                    <param id="2" name="Image point">3</param>
                </action>
                <action disabled="1" id="5" name="Set frame" type="spit">
                    <param id="0" name="Frame number">head.player_number</param>
                </action>
                <action disabled="1" id="2" name="Stop" type="spit" />
            </actions>
        </event-block>
        <event-group collapsed="1" description="" title="Movement">
            <sub-events>
                <comment>mention that at logging, only the first action is output! so not correct for all affected segments, but only the first!</comment>
                <event-block>
                    <conditions>
                        <condition id="-1" name="Every tick" type="System" />
                        <condition disabled="1" id="-3" name="Is on-screen" type="segment" />
                        <condition disabled="1" id="-4" inverted="1" name="Is outside layout" type="segment" />
                        <condition disabled="1" id="1" name="Is overlapping another object" type="segment">
                            <param id="0" name="Object">head</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="-17" name="Move forward" type="segment">
                            <param id="0" name="Distance">1</param>
                        </action>
                        <action disabled="1" id="0" name="Log Text" type="ChromeConsole">
                            <param id="0" name="Data">segment(1).X &amp; &quot; targetSegment uid&quot; &amp; segment(1).targetSegmentUID &amp; &quot; iid&quot; &amp; segment(1).targetSegmentIID &amp; &quot; headUid&quot; &amp; segment(1).headUID &amp; &quot; headIid&quot; &amp; segment(1).headIID &amp; &quot; segmentUid&quot; &amp; segment(1).UID &amp; &quot; segmentIid&quot; &amp; segment(1).IID</param>
                        </action>
                    </actions>
                    <sub-events>
                        <comment>the sub-event for head-picking is easier to understand - but picking another segment is not possible</comment>
                        <comment>this is the branch if the segment is the first one - directly position to the imagepoint of the head (so no interpolation)</comment>
                        <event-block>
                            <conditions>
                                <condition id="-7" name="Compare instance variable" type="segment">
                                    <param id="0" name="Instance variable">targetSegmentUID</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">segment.headUID</param>
                                </condition>
                                <condition disabled="1" id="-7" name="Compare instance variable" type="segment">
                                    <param id="0" name="Instance variable">range</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Value">distance(self.X, self.Y, head.X, head.Y)</param>
                                </condition>
                                <condition id="-8" name="Is boolean instance variable set" type="segment">
                                    <param id="0" name="Instance variable">enabled</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-21" name="Rotate toward position" type="segment">
                                    <param id="0" name="Degrees">10</param>
                                    <param id="1" name="X">head(segment.targetSegmentIID).ImagePointX(2)</param>
                                    <param id="2" name="Y">head(segment.targetSegmentIID).ImagePointY(2)</param>
                                </action>
                                <action id="-3" name="Set position" type="segment">
                                    <param id="0" name="X">head(segment.targetSegmentIID).ImagePointX(2)</param>
                                    <param id="1" name="Y">head(segment.targetSegmentIID).ImagePointY(2)</param>
                                </action>
                                <action disabled="1" id="0" name="Log Text" type="ChromeConsole">
                                    <param id="0" name="Data">&quot;segment is the first, these are equal targetSegment uid&quot; &amp; segment.targetSegmentUID &amp; &quot; iid&quot; &amp;  segment.targetSegmentIID &amp; &quot;, segment.headUID: &quot; &amp; segment.headUID &amp; &quot; segmentIID&quot; &amp; segment.IID</param>
                                </action>
                            </actions>
                            <sub-events>
                                <comment>ATTENTION: picking does NOT work here, as not all heads of the start segments, but only one would be processed!</comment>
                                <event-block disabled="1">
                                    <conditions>
                                        <condition disabled="1" id="-14" name="Pick by unique ID" type="head">
                                            <param id="0" name="Unique ID">segment.headUID</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="-21" name="Rotate toward position" type="segment">
                                            <param id="0" name="Degrees">10</param>
                                            <param id="1" name="X">head.ImagePointX(2)</param>
                                            <param id="2" name="Y">head.ImagePointY(2)</param>
                                        </action>
                                        <action disabled="1" id="-3" name="Set position" type="segment">
                                            <param id="0" name="X">head.ImagePointX(2)</param>
                                            <param id="1" name="Y">head.ImagePointY(2)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>branch for all segments not being the first of head</comment>
                        <event-block>
                            <conditions>
                                <condition id="-7" inverted="1" name="Compare instance variable" type="segment">
                                    <param id="0" name="Instance variable">targetSegmentUID</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">segment.headUID</param>
                                </condition>
                                <condition id="-8" name="Is boolean instance variable set" type="segment">
                                    <param id="0" name="Instance variable">enabled</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="0" name="Log Text" type="ChromeConsole">
                                    <param id="0" name="Data">&quot;moving to target uid&quot; &amp; segment.targetSegmentUID &amp; &quot; iid&quot; &amp;  segment.targetSegmentIID &amp;&quot;, segment.headUID: &quot; &amp; segment.headUID &amp; &quot; segmentIID&quot; &amp; segment.IID</param>
                                </action>
                            </actions>
                            <sub-events>
                                <comment>setting the position directly may help for debugging the game, as it is mor clear which target segments the segments are attached to!</comment>
                                <event-block>
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" type="segment">
                                            <param id="0" name="Instance variable">range</param>
                                            <param id="1" name="Comparison">4</param>
                                            <param id="2" name="Value">distance(self.X, self.Y, segment(self.targetSegmentIID).X, segment(self.targetSegmentIID).Y)</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-3" name="Set position" type="segment">
                                            <param id="0" name="X">lerp(self.X, segment(self.targetSegmentIID).ImagePointX(2), 1-0.0001^dt)</param>
                                            <param id="1" name="Y">lerp(self.Y, segment(self.targetSegmentIID).ImagePointY(2), 1-0.0001^dt)</param>
                                        </action>
                                        <action id="-20" name="Rotate toward angle" type="segment">
                                            <param id="0" name="Degrees">3</param>
                                            <param id="1" name="Angle">segment(self.targetSegmentIID).Angle</param>
                                        </action>
                                        <action disabled="1" id="-3" name="Set position" type="segment">
                                            <param id="0" name="X">segment(self.targetSegmentIID).ImagePointX(2)</param>
                                            <param id="1" name="Y">segment(self.targetSegmentIID).ImagePointY(2)</param>
                                        </action>
                                        <action disabled="1" id="-21" name="Rotate toward position" type="segment">
                                            <param id="0" name="Degrees">10</param>
                                            <param id="1" name="X">segment(self.targetSegmentIID).ImagePointX(2)</param>
                                            <param id="2" name="Y">segment(self.targetSegmentIID).ImagePointY(2)</param>
                                        </action>
                                        <action disabled="1" id="-17" name="Move forward" type="segment">
                                            <param id="0" name="Distance">distance(self.X, self.Y, segment(self.targetSegmentIID).X, segment(self.targetSegmentIID).Y)</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>this forces the warp </comment>
                                <event-block>
                                    <conditions>
                                        <condition id="-7" inverted="1" name="Compare instance variable" type="segment">
                                            <param id="0" name="Instance variable">range</param>
                                            <param id="1" name="Comparison">4</param>
                                            <param id="2" name="Value">distance(self.X, self.Y, segment(self.targetSegmentIID).X, segment(self.targetSegmentIID).Y)</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="-17" name="Move forward" type="segment">
                                            <param id="0" name="Distance">3</param>
                                        </action>
                                        <action id="-3" name="Set position" type="segment">
                                            <param id="0" name="X">segment(self.targetSegmentIID).ImagePointX(2)</param>
                                            <param id="1" name="Y">segment(self.targetSegmentIID).ImagePointY(2)</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="handle collisions between head and food" title="Collisions">
            <sub-events>
                <event-block>
                    <conditions>
                        <condition id="0" name="On collision with another object" type="head">
                            <param id="0" name="Object">food</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Destroy" type="food" />
                    </actions>
                    <sub-events>
                        <event-group description="" title="Health and Strength Calculation">
                            <sub-events>
                                <comment>the total strength is increased by the current numberOfSegments which all get upgraded with food.health, the health add for the head, and the health of the new segment</comment>
                                <event-block>
                                    <conditions />
                                    <actions>
                                        <action id="-11" name="Add to" type="head">
                                            <param id="0" name="Instance variable">health</param>
                                            <param id="1" name="Value">food.health</param>
                                        </action>
                                        <action id="-11" name="Add to" type="head">
                                            <param id="0" name="Instance variable">totalStrength</param>
                                            <param id="1" name="Value">food.health+head.numberOfSegments*food.health + segmentInitialHealth</param>
                                        </action>
                                        <action id="-5" name="Set width" type="head">
                                            <param id="0" name="Width">head.initialWidth*(1+ ((head.health/head.initialHealth-1)*head.scaleFactor))</param>
                                        </action>
                                        <action id="-6" name="Set height" type="head">
                                            <param id="0" name="Height">head.initialHeight*(1+ ((head.health/head.initialHealth-1)*head.scaleFactor))</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>health and strength calcluation</comment>
                                <event-block>
                                    <conditions>
                                        <condition id="-19" name="Pick all" type="System">
                                            <param id="0" name="Object">segment</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block>
                                            <conditions>
                                                <condition id="-7" name="Compare instance variable" type="segment">
                                                    <param id="0" name="Instance variable">headIID</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">head.IID</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-11" name="Add to" type="segment">
                                                    <param id="0" name="Instance variable">health</param>
                                                    <param id="1" name="Value">food.health</param>
                                                </action>
                                                <action id="-5" name="Set width" type="segment">
                                                    <param id="0" name="Width">segment.initialSize*(1+ ((segment.health/segment.initialHealth-1)*segment.scaleFactor))</param>
                                                </action>
                                                <action id="-6" name="Set height" type="segment">
                                                    <param id="0" name="Height">segment.initialSize*(1+ ((segment.health/segment.initialHealth-1)*segment.scaleFactor))</param>
                                                </action>
                                                <action id="0" name="Log Text" type="ChromeConsole">
                                                    <param id="0" name="Data">&quot;new health value: &quot; &amp; segment.health &amp; &quot;, scale factor: &quot; &amp; segment.health/segment.initialHealth</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-group>
                        <variable name="createdSegmentIID" type="number">0</variable>
                        <variable name="previousLastSegmentUID" type="number">0</variable>
                        <event-block>
                            <conditions>
                                <condition id="-7" inverted="1" name="Compare instance variable" type="head">
                                    <param id="0" name="Instance variable">numberOfSegments</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Create object" type="System">
                                    <param id="0" name="Object to create">segment</param>
                                    <param id="1" name="Layer">0</param>
                                    <param id="2" name="X">segment(head.lastSegmentIID).ImagePointX(1)</param>
                                    <param id="3" name="Y">segment(head.lastSegmentIID).ImagePointY(1)</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">targetSegmentUID</param>
                                    <param id="1" name="Value">head.lastSegementUID</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">targetSegmentIID</param>
                                    <param id="1" name="Value">head.lastSegmentIID</param>
                                </action>
                                <action id="-10" name="Set value" type="head">
                                    <param id="0" name="Instance variable">lastSegementUID</param>
                                    <param id="1" name="Value">segment.UID</param>
                                </action>
                                <action id="-10" name="Set value" type="head">
                                    <param id="0" name="Instance variable">lastSegmentIID</param>
                                    <param id="1" name="Value">segment.IID</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">headUID</param>
                                    <param id="1" name="Value">head.UID</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">headIID</param>
                                    <param id="1" name="Value">head.IID</param>
                                </action>
                                <action id="-11" name="Add to" type="head">
                                    <param id="0" name="Instance variable">numberOfSegments</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">segmentNumberInSnake</param>
                                    <param id="1" name="Value">head.numberOfSegments</param>
                                </action>
                                <action id="-9" name="Set value" type="System">
                                    <param id="0" name="Variable">createdSegmentIID</param>
                                    <param id="1" name="Value">segment.IID</param>
                                </action>
                                <action id="-9" name="Set value" type="System">
                                    <param id="0" name="Variable">previousLastSegmentUID</param>
                                    <param id="1" name="Value">segment.targetSegmentUID</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">player_number</param>
                                    <param id="1" name="Value">head.player_number</param>
                                </action>
                                <action id="0" name="Log Text" type="ChromeConsole">
                                    <param id="0" name="Data">&quot;___new segment for non-empty snake with head iid&quot; &amp; head.IID &amp; &quot; uid&quot; &amp; head.UID &amp; &quot;, segNum: &quot; &amp; head.numberOfSegments &amp; &quot;, created IID: &quot; &amp; segment.IID &amp; &quot; uid&quot; &amp; segment.UID</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block>
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" type="head">
                                            <param id="0" name="Instance variable">player_number</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="5" name="Set frame" type="segment">
                                            <param id="0" name="Frame number">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                                <comment>wihtout this pick, only the head would be picked!</comment>
                                <event-block>
                                    <conditions>
                                        <condition id="-19" name="Pick all" type="System">
                                            <param id="0" name="Object">segment</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block>
                                            <conditions>
                                                <condition id="-14" name="Pick by unique ID" type="segment">
                                                    <param id="0" name="Unique ID">previousLastSegmentUID</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" type="segment">
                                                    <param id="0" name="Instance variable">trailingSegmentIID</param>
                                                    <param id="1" name="Value">createdSegmentIID</param>
                                                </action>
                                                <action id="0" name="Set text" type="DebugText1">
                                                    <param id="0" name="Text">&quot;trailingIID:&quot; &amp; segment.trailingSegmentIID</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <comment>this handles the case if the snake has no segments</comment>
                        <event-block>
                            <conditions>
                                <condition id="-7" name="Compare instance variable" type="head">
                                    <param id="0" name="Instance variable">numberOfSegments</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">0</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Create object" type="System">
                                    <param id="0" name="Object to create">segment</param>
                                    <param id="1" name="Layer">0</param>
                                    <param id="2" name="X">head.ImagePointX(1)</param>
                                    <param id="3" name="Y">head.ImagePointY(1)</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">targetSegmentUID</param>
                                    <param id="1" name="Value">head.UID</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">targetSegmentIID</param>
                                    <param id="1" name="Value">head.IID</param>
                                </action>
                                <action id="-10" name="Set value" type="head">
                                    <param id="0" name="Instance variable">lastSegementUID</param>
                                    <param id="1" name="Value">segment.UID</param>
                                </action>
                                <action id="-10" name="Set value" type="head">
                                    <param id="0" name="Instance variable">lastSegmentIID</param>
                                    <param id="1" name="Value">segment.IID</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">headUID</param>
                                    <param id="1" name="Value">head.UID</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">headIID</param>
                                    <param id="1" name="Value">head.IID</param>
                                </action>
                                <action id="-11" name="Add to" type="head">
                                    <param id="0" name="Instance variable">numberOfSegments</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">segmentNumberInSnake</param>
                                    <param id="1" name="Value">head.numberOfSegments</param>
                                </action>
                                <action id="-10" name="Set value" type="segment">
                                    <param id="0" name="Instance variable">player_number</param>
                                    <param id="1" name="Value">head.player_number</param>
                                </action>
                                <action id="0" name="Log Text" type="ChromeConsole">
                                    <param id="0" name="Data">&quot;___new segment for empty snake with head iid&quot; &amp; head.IID &amp; &quot; uid&quot; &amp; head.UID &amp; &quot;, segNum(should be 1): &quot; &amp; head.numberOfSegments &amp; &quot;, created IID: &quot; &amp; segment.IID &amp; &quot; uid&quot; &amp; segment.UID</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block>
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" type="head">
                                            <param id="0" name="Instance variable">player_number</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">1</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="5" name="Set frame" type="segment">
                                            <param id="0" name="Frame number">1</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block disabled="1">
                            <conditions>
                                <condition disabled="1" id="-13" name="Pick nth instance" type="System">
                                    <param id="0" name="Object">segment</param>
                                    <param id="1" name="Instance">-1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="-10" name="Set value" type="head">
                                    <param id="0" name="Instance variable">lastSegementUID</param>
                                    <param id="1" name="Value">segment.IID</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-block>
            <conditions>
                <condition id="-1" name="Every tick" type="System" />
            </conditions>
            <actions>
                <action id="-17" name="Move forward" type="head">
                    <param id="0" name="Distance">3</param>
                </action>
            </actions>
        </event-block>
        <event-group description="" title="spitting">
            <sub-events>
                <variable name="collisionIID" type="number">-1</variable>
                <variable name="pre1IID" type="number">-1</variable>
                <variable name="pre2IID" type="number">-1</variable>
                <variable comment="one to the front, needed to set the new lastSegmentUID for the old head" name="front1IID" type="number">-1</variable>
                <variable name="collidedHeadIID" type="number">-1</variable>
                <variable name="localSegmentNumberInSnake" type="number">-1</variable>
                <comment>mention that it is NOT safe to destroy objects, as the IIDs change then!!!</comment>
                <event-block>
                    <conditions>
                        <condition id="0" name="On collision with another object" type="spit">
                            <param id="0" name="Object">segment</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" type="System">
                            <param id="0" name="Variable">collisionIID</param>
                            <param id="1" name="Value">segment.IID</param>
                        </action>
                        <action id="-9" name="Set value" type="System">
                            <param id="0" name="Variable">pre1IID</param>
                            <param id="1" name="Value">segment.trailingSegmentIID</param>
                        </action>
                        <action id="0" name="Set text" type="DebugText1">
                            <param id="0" name="Text">&quot;collIID: &quot; &amp; collisionIID &amp; &quot;, collUID: &quot; &amp; segment.UID</param>
                        </action>
                        <action id="-9" name="Set value" type="System">
                            <param id="0" name="Variable">collidedHeadIID</param>
                            <param id="1" name="Value">segment.headIID</param>
                        </action>
                        <action id="-9" name="Set value" type="System">
                            <param id="0" name="Variable">front1IID</param>
                            <param id="1" name="Value">segment.targetSegmentIID</param>
                        </action>
                        <action id="-9" name="Set value" type="System">
                            <param id="0" name="Variable">localSegmentNumberInSnake</param>
                            <param id="1" name="Value">segment.segmentNumberInSnake</param>
                        </action>
                        <action id="-9" name="Destroy" type="spit" />
                        <action disabled="1" id="-9" name="Destroy" type="segment" />
                        <action id="0" name="Log Text" type="ChromeConsole">
                            <param id="0" name="Data">&quot;collision with segmentIID&quot; &amp; segment.IID &amp; &quot; segmentUID&quot; &amp; segment.UID &amp; &quot;, segmentNumberInSnake: &quot; &amp; segment.segmentNumberInSnake &amp; &quot;, collidedHeadIID&quot; &amp; segment.headIID</param>
                        </action>
                        <action id="-15" name="Set visible" type="segment">
                            <param id="0" name="Visibility">0</param>
                        </action>
                        <action id="-13" name="Set boolean" type="segment">
                            <param id="0" name="Instance variable">enabled</param>
                            <param id="1" name="Value">0</param>
                        </action>
                        <action id="-3" name="Set position" type="segment">
                            <param id="0" name="X">-100</param>
                            <param id="1" name="Y">-100</param>
                        </action>
                    </actions>
                    <sub-events>
                        <comment>this SHOULD pick all segment again, but it doesnt!?!</comment>
                        <event-block>
                            <conditions>
                                <condition id="-19" name="Pick all" type="System">
                                    <param id="0" name="Object">segment</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <variable name="createdHeadUID" type="number">-1</variable>
                                <variable name="createdHeadIID" type="number">-1</variable>
                                <comment>if pre1IID is !=-1, this means there is at least one more trailing segment</comment>
                                <comment>the new head is created at this position of the previous segment</comment>
                                <comment>mention that it is NOT safe to destroy objects, as the IIDs change then!!!</comment>
                                <event-block>
                                    <conditions>
                                        <condition id="-14" name="Compare variable" type="System">
                                            <param id="0" name="Variable">pre1IID</param>
                                            <param id="1" name="Comparison">1</param>
                                            <param id="2" name="Value">-1</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <event-block>
                                            <conditions>
                                                <condition id="-13" name="Pick nth instance" type="System">
                                                    <param id="0" name="Object">segment</param>
                                                    <param id="1" name="Instance">pre1IID</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Set value" type="System">
                                                    <param id="0" name="Variable">pre2IID</param>
                                                    <param id="1" name="Value">segment.trailingSegmentIID</param>
                                                </action>
                                                <action id="1" name="Append text" type="DebugText1">
                                                    <param id="0" name="Text">&quot;, pre1 uid: &quot; &amp; segment.UID &amp; &quot;, pre1 iid: &quot; &amp; segment.IID</param>
                                                </action>
                                                <action id="0" name="Spawn another object" type="segment">
                                                    <param id="0" name="Object">head</param>
                                                    <param id="1" name="Layer">0</param>
                                                    <param id="2" name="Image point">0</param>
                                                </action>
                                                <action id="-9" name="Set value" type="System">
                                                    <param id="0" name="Variable">createdHeadIID</param>
                                                    <param id="1" name="Value">head.IID</param>
                                                </action>
                                                <action id="-9" name="Set value" type="System">
                                                    <param id="0" name="Variable">createdHeadUID</param>
                                                    <param id="1" name="Value">head.UID</param>
                                                </action>
                                                <action id="-10" name="Set value" type="head">
                                                    <param id="0" name="Instance variable">player_number</param>
                                                    <param id="1" name="Value">segment.player_number</param>
                                                </action>
                                                <action id="2" name="Stop" type="head" />
                                                <action disabled="1" id="-9" name="Destroy" type="segment" />
                                                <action id="0" name="Log Text" type="ChromeConsole">
                                                    <param id="0" name="Data">&quot;create head with UID&quot; &amp; head.UID &amp; &quot;, IID: &quot; &amp; head.IID &amp; &quot;, segments: &quot; &amp; head.numberOfSegments</param>
                                                </action>
                                                <action id="-15" name="Set visible" type="segment">
                                                    <param id="0" name="Visibility">0</param>
                                                </action>
                                                <action id="-13" name="Set boolean" type="segment">
                                                    <param id="0" name="Instance variable">enabled</param>
                                                    <param id="1" name="Value">0</param>
                                                </action>
                                                <action id="-3" name="Set position" type="segment">
                                                    <param id="0" name="X">-100</param>
                                                    <param id="1" name="Y">-100</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <comment>if pre2IID is !=-1, this means there are at least two more trailing segments, which all must be modified</comment>
                                <event-block>
                                    <conditions>
                                        <condition id="-14" name="Compare variable" type="System">
                                            <param id="0" name="Variable">pre2IID</param>
                                            <param id="1" name="Comparison">1</param>
                                            <param id="2" name="Value">-1</param>
                                        </condition>
                                    </conditions>
                                    <actions />
                                    <sub-events>
                                        <variable name="segmentIIDIterator" type="number">-1</variable>
                                        <event-block>
                                            <conditions>
                                                <condition id="-13" name="Pick nth instance" type="System">
                                                    <param id="0" name="Object">segment</param>
                                                    <param id="1" name="Instance">pre2IID</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="1" name="Append text" type="DebugText1">
                                                    <param id="0" name="Text">&quot;, pre2 uid: &quot; &amp; segment.UID &amp; &quot;, pre2 iid: &quot; &amp; segment.IID</param>
                                                </action>
                                                <action id="-10" name="Set value" type="segment">
                                                    <param id="0" name="Instance variable">targetSegmentUID</param>
                                                    <param id="1" name="Value">createdHeadUID</param>
                                                </action>
                                                <action id="-10" name="Set value" type="segment">
                                                    <param id="0" name="Instance variable">targetSegmentIID</param>
                                                    <param id="1" name="Value">createdHeadIID</param>
                                                </action>
                                                <action id="-10" name="Set value" type="segment">
                                                    <param id="0" name="Instance variable">headUID</param>
                                                    <param id="1" name="Value">createdHeadUID</param>
                                                </action>
                                                <action id="-10" name="Set value" type="segment">
                                                    <param id="0" name="Instance variable">headIID</param>
                                                    <param id="1" name="Value">createdHeadIID</param>
                                                </action>
                                                <action id="-9" name="Set value" type="System">
                                                    <param id="0" name="Variable">segmentIIDIterator</param>
                                                    <param id="1" name="Value">pre2IID</param>
                                                </action>
                                                <action id="0" name="Log Text" type="ChromeConsole">
                                                    <param id="0" name="Data">&quot;set target and head of segment to IID: &quot; &amp; createdHeadIID</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <comment>iterate over all trailing segments that have a new head</comment>
                                        <event-block>
                                            <conditions>
                                                <condition id="-12" name="Repeat" type="System">
                                                    <param id="0" name="Count">40</param>
                                                </condition>
                                            </conditions>
                                            <actions />
                                            <sub-events>
                                                <event-block>
                                                    <conditions>
                                                        <condition id="-14" name="Compare variable" type="System">
                                                            <param id="0" name="Variable">segmentIIDIterator</param>
                                                            <param id="1" name="Comparison">1</param>
                                                            <param id="2" name="Value">-1</param>
                                                        </condition>
                                                    </conditions>
                                                    <actions>
                                                        <action id="0" name="Log Text" type="ChromeConsole">
                                                            <param id="0" name="Data">&quot;iterating over segIID: &quot; &amp; segmentIIDIterator &amp; &quot; segUID&quot; &amp; segment(segmentIIDIterator).UID &amp; &quot;, headIID: &quot; &amp; createdHeadIID</param>
                                                        </action>
                                                    </actions>
                                                    <sub-events>
                                                        <comment></comment>
                                                        <event-block>
                                                            <conditions>
                                                                <condition id="-13" name="Pick nth instance" type="System">
                                                                    <param id="0" name="Object">head</param>
                                                                    <param id="1" name="Instance">createdHeadIID</param>
                                                                </condition>
                                                            </conditions>
                                                            <actions>
                                                                <action id="-10" name="Set value" type="head">
                                                                    <param id="0" name="Instance variable">lastSegmentIID</param>
                                                                    <param id="1" name="Value">segmentIIDIterator</param>
                                                                </action>
                                                                <action id="-10" name="Set value" type="head">
                                                                    <param id="0" name="Instance variable">lastSegementUID</param>
                                                                    <param id="1" name="Value">segment(segmentIIDIterator).UID</param>
                                                                </action>
                                                                <action id="-11" name="Add to" type="head">
                                                                    <param id="0" name="Instance variable">numberOfSegments</param>
                                                                    <param id="1" name="Value">1</param>
                                                                </action>
                                                                <action id="0" name="Log Text" type="ChromeConsole">
                                                                    <param id="0" name="Data">&quot;numberSegments after inc:&quot; &amp; head.numberOfSegments &amp; &quot; for headUID:&quot; &amp; head.UID &amp; &quot;, headIID: &quot; &amp;head.IID</param>
                                                                </action>
                                                                <action id="0" name="Log Text" type="ChromeConsole">
                                                                    <param id="0" name="Data">&quot;setting lastSegmentIID to: &quot; &amp; segmentIIDIterator &amp; &quot;, lastSegmentUID to: &quot; &amp; head.lastSegementUID</param>
                                                                </action>
                                                                <action disabled="1" id="1" name="Log Object" type="ChromeConsole">
                                                                    <param id="0" name="Object">head</param>
                                                                </action>
                                                            </actions>
                                                        </event-block>
                                                        <comment>the target needs not to be set, because only the first target changes (the pre2IID) which is done above!</comment>
                                                        <event-block>
                                                            <conditions>
                                                                <condition id="-13" name="Pick nth instance" type="System">
                                                                    <param id="0" name="Object">segment</param>
                                                                    <param id="1" name="Instance">segmentIIDIterator</param>
                                                                </condition>
                                                            </conditions>
                                                            <actions>
                                                                <action id="-9" name="Set value" type="System">
                                                                    <param id="0" name="Variable">segmentIIDIterator</param>
                                                                    <param id="1" name="Value">segment.trailingSegmentIID</param>
                                                                </action>
                                                                <action id="-10" name="Set value" type="segment">
                                                                    <param id="0" name="Instance variable">headIID</param>
                                                                    <param id="1" name="Value">createdHeadIID</param>
                                                                </action>
                                                                <action id="-10" name="Set value" type="segment">
                                                                    <param id="0" name="Instance variable">headUID</param>
                                                                    <param id="1" name="Value">createdHeadUID</param>
                                                                </action>
                                                                <action id="-10" name="Set value" type="segment">
                                                                    <param id="0" name="Instance variable">segmentNumberInSnake</param>
                                                                    <param id="1" name="Value">head(createdHeadIID).numberOfSegments</param>
                                                                </action>
                                                                <action id="0" name="Log Text" type="ChromeConsole">
                                                                    <param id="0" name="Data">&quot;setting segmentNumberInSnake: &quot; &amp; segment.segmentNumberInSnake &amp; &quot;, original head number: &quot; &amp; head(createdHeadIID).numberOfSegments &amp; &quot;, head iid: &quot; &amp; createdHeadIID</param>
                                                                </action>
                                                                <action disabled="1" id="1" name="Log Object" type="ChromeConsole">
                                                                    <param id="0" name="Object">segment</param>
                                                                </action>
                                                                <action id="-3" name="Set position" type="segment">
                                                                    <param id="0" name="X">segment(segment.targetSegmentIID).ImagePointX(2)</param>
                                                                    <param id="1" name="Y">segment(segment.targetSegmentIID).ImagePointY(2)</param>
                                                                </action>
                                                            </actions>
                                                        </event-block>
                                                    </sub-events>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                                <comment>set the number of segments of the OLD head to one decreased number; the lastSegmentNumber of the old head must be set to the frontIID</comment>
                                <event-block>
                                    <conditions>
                                        <condition id="-13" name="Pick nth instance" type="System">
                                            <param id="0" name="Object">head</param>
                                            <param id="1" name="Instance">collidedHeadIID</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-10" name="Set value" type="head">
                                            <param id="0" name="Instance variable">numberOfSegments</param>
                                            <param id="1" name="Value">localSegmentNumberInSnake-1</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block>
                                            <conditions>
                                                <condition id="-7" name="Compare instance variable" type="head">
                                                    <param id="0" name="Instance variable">numberOfSegments</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" type="head">
                                                    <param id="0" name="Instance variable">lastSegmentIID</param>
                                                    <param id="1" name="Value">-1</param>
                                                </action>
                                                <action id="-10" name="Set value" type="head">
                                                    <param id="0" name="Instance variable">lastSegementUID</param>
                                                    <param id="1" name="Value">-1</param>
                                                </action>
                                            </actions>
                                        </event-block>
                                        <event-block>
                                            <conditions>
                                                <condition disabled="1" id="-7" name="Compare instance variable" type="head">
                                                    <param id="0" name="Instance variable">numberOfSegments</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">0</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-10" name="Set value" type="head">
                                                    <param id="0" name="Instance variable">lastSegmentIID</param>
                                                    <param id="1" name="Value">front1IID</param>
                                                </action>
                                                <action id="-10" name="Set value" type="head">
                                                    <param id="0" name="Instance variable">lastSegementUID</param>
                                                    <param id="1" name="Value">segment(front1IID).UID</param>
                                                </action>
                                            </actions>
                                            <sub-events>
                                                <event-block>
                                                    <conditions />
                                                    <actions>
                                                        <action id="0" name="Log Text" type="ChromeConsole">
                                                            <param id="0" name="Data">&quot;original head numSegments &quot; &amp; head.numberOfSegments &amp; &quot;, lastSegmentIID&quot; &amp; head.lastSegmentIID &amp; &quot;, lastSegmentUID&quot; &amp; head.lastSegementUID</param>
                                                        </action>
                                                    </actions>
                                                </event-block>
                                            </sub-events>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" title="Debugging">
            <sub-events>
                <event-block>
                    <conditions>
                        <condition id="-1" name="Every tick" type="System" />
                        <condition id="-7" name="Compare instance variable" type="head">
                            <param id="0" name="Instance variable">player_number</param>
                            <param id="1" name="Comparison">0</param>
                            <param id="2" name="Value">0</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Set text" type="DebugText2">
                            <param id="0" name="Text">&quot;numSegments: &quot; &amp; head.numberOfSegments &amp; &quot;, lastSegIID: &quot; &amp; head.lastSegmentIID &amp; &quot;lastSegUID: &quot; &amp;head.lastSegementUID</param>
                        </action>
                    </actions>
                </event-block>
                <event-block>
                    <conditions>
                        <condition id="6" name="On object clicked" type="Mouse">
                            <param id="0" name="Mouse button">0</param>
                            <param id="1" name="Click type">0</param>
                            <param id="2" name="Object clicked">head</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="0" name="Set text" type="DebugText3">
                            <param id="0" name="Text">&quot;head IID&quot; &amp; head.IID &amp; &quot;, UID&quot; &amp; head.UID &amp; &quot;, numSegments: &quot; &amp; head.numberOfSegments &amp; &quot;, lastSegIID: &quot; &amp; head.lastSegmentIID &amp; &quot;lastSegUID: &quot; &amp;head.lastSegementUID</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
